// https://repl.it/BFZQ/19
// UNCOMMENT commented console.log statements FOR DEBUGGING
// UNCOMMENT code between START and END ignore lines FOR DEBUGGING

function where(collection, source) {
    var src_key = Object.keys(source);

    ////START ignore these lines
    console.log('Collection: ', collection); // show the collection
    console.log('Source    : ', source); // show the source
    // console.log('SourceKeys: ', src_key);
    ////END ignore till here

    return collection.filter(function (item, index) {
        // console.log('\n====== FOR OBJECT [' + index + ']: ', item);

        var ret = true; // return value
        for (var i = 0; i < src_key.length; i++) {

            ////START ignore these lines
            // console.log('Continue loop for next key in source');
            // console.log('------ FOR SOURCE KEY [' + src_key[i] + ']');
            // console.log('Item  : prop =  ' + src_key[i] + ', value = ' + item[src_key[i]]);
            // console.log('Source: prop =  ' + src_key[i] + ', value = ' + source[src_key[i]]);
            ////END ignore till here

            // if the src_key[i] is present as a property in item object
            // then check if value of property in item is equal to the value of the same prop. in source
            if (item.hasOwnProperty(src_key[i]) &&
                item[src_key[i]] === source[src_key[i]]) {
            }
            else {
                ret = false;
            }
        }

        ////START ignore these lines
        // if (ret) {
        //     console.log('>> Return true');
        //     console.log('> Object included :)');
        // }
        // else {
        //     console.log('>> Return false');
        //     console.log('> Object NOT included :(');
        // }
        ////END ignore till here

        return ret;
    });
}


console.log('=================================================\nOutput: ', where([{ first: 'Romeo', last: 'Montague' }, { first: 'Mercutio', last: null }, { first: 'Tybalt', last: 'Capulet' }], { last: 'Capulet' }));
console.log('\n\n#################################################\n\n');
console.log('=================================================\nOutput: ', where([{ 'a': 5 }, { 'a': 5 }, { 'a': 5, 'b': 10 }], { 'a': 5, 'b': 10 }));
console.log('\n\n#################################################\n\n');
console.log('=================================================\nOutput: ', where([{ 'a': 1, 'b': 2 }, { 'a': 1 }, { 'a': 1, 'b': 2, 'c': 2 }], { 'a': 1, 'b': 2 }));

console.log('\n\n#################################################\n\n');
console.log('=================================================\nOutput: ', where([{ 'a': 1, 'b': 2 }, { 'a': 1 }, { 'a': 1, 'b': 2, 'c': 2 }], { 'd': 3, 'a': 1, 'b': 2 }));
